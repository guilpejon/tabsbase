# Secrets defined here are available for reference under registry/password, env/secret, builder/secrets,
# and accessories/*/env/secret in config/deploy.yml. All secrets should be pulled from either
# password manager, ENV, or a file. DO NOT ENTER RAW CREDENTIALS HERE! This file needs to be safe for git.

# Option 1: Use environment variables (recommended for CI/CD)
# Export these in your shell before running kamal:
#   export KAMAL_REGISTRY_PASSWORD="your-docker-hub-token"
#   export TABSBASE_DATABASE_PASSWORD="your-secure-db-password"

# Read secrets directly from 1Password using op CLI
# This avoids the escaping issues with kamal secrets fetch/extract
KAMAL_REGISTRY_PASSWORD=$(op read "op://Personal/TabsBase/KAMAL_REGISTRY_PASSWORD")
RAILS_MASTER_KEY=$(op read "op://Personal/TabsBase/RAILS_MASTER_KEY")
TABSBASE_DATABASE_PASSWORD=$(op read "op://Personal/TabsBase/TABSBASE_DATABASE_PASSWORD")

# Docker Hub access token (create one at https://hub.docker.com/settings/security)
# Or use GitHub Container Registry token: KAMAL_REGISTRY_PASSWORD=$(gh auth token)
# KAMAL_REGISTRY_PASSWORD=$KAMAL_REGISTRY_PASSWORD

# PostgreSQL password - used by both the app and the database accessory
# TABSBASE_DATABASE_PASSWORD=$TABSBASE_DATABASE_PASSWORD

# PostgreSQL password for the accessory (same as above)
POSTGRES_PASSWORD=$TABSBASE_DATABASE_PASSWORD

# DATABASE_URL forces TCP connection (not Unix socket)
# The hostname 'tabsbase-db' is the Docker container name on the kamal network
DATABASE_URL="postgresql://tabsbase:${TABSBASE_DATABASE_PASSWORD}@tabsbase-db:5432/tabsbase_production"
